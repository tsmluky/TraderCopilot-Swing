# backend/data/supported_tokens.py

# Free Plan: Basic Major Caps
VALID_TOKENS_FREE = ["BTC", "ETH", "SOL"]

# Pro / Trader Plan: Top ~150 Tokens (High Volume / Liquid)
VALID_TOKENS_FULL = [
    # Top 10
    "BTC",
    "ETH",
    "SOL",
    "BNB",
    "XRP",
    "ADA",
    "DOGE",
    "AVAX",
    "DOT",
    "MATIC",
    # Top 20-50
    "TRX",
    "LTC",
    "SHIB",
    "UNI",
    "ATOM",
    "LINK",
    "XLM",
    "BCH",
    "ALGO",
    "NEAR",
    "FIL",
    "VET",
    "ICP",
    "HBAR",
    "EGLD",
    "SAND",
    "MANA",
    "AXS",
    "THETA",
    "EOS",
    "AAVE",
    "XTZ",
    "FLOW",
    "FTM",
    "GRT",
    "KCS",
    "MKR",
    "SNX",
    "ZEC",
    "RUNE",
    # Top 50-100 (Defi/L1/L2/Gaming)
    "NEO",
    "CRV",
    "CHZ",
    "BAT",
    "ENJ",
    "DASH",
    "CAKE",
    "STX",
    "SUSHI",
    "COMP",
    "ZIL",
    "YFI",
    "1INCH",
    "LRC",
    "WAVES",
    "KSM",
    "RVN",
    "ONE",
    "OMG",
    "ONT",
    "IOST",
    "QTUM",
    "ICX",
    "ANKR",
    "ZEN",
    "ZRX",
    "DGB",
    "SC",
    "UMA",
    "HOT",
    # Emerging / Meme / New Gen
    "PEPE",
    "FLOKI",
    "BONK",
    "WIF",
    "JUP",
    "PYTH",
    "TIA",
    "SEI",
    "SUI",
    "APT",
    "ARB",
    "OP",
    "BLUR",
    "LDO",
    "RNDR",
    "INJ",
    "IMX",
    "KAS",
    "FET",
    "AGIX",
    "OCEAN",
    "GALA",
    "CFX",
    "ACH",
    "WOO",
    "JASMY",
    "GLM",
    "GMT",
    "APE",
    "LUNC",
    # Stablecoins excluded usually for trading, but useful for reference if needed.
    # Excluded: USDT, USDC, DAI, FDUSD
]


def get_tokens_for_plan(plan: str) -> list[str]:
    """Returns the list of allowed tokens for a given user plan."""
    if plan.upper() in ["PRO", "TRADER", "WHALE", "OWNER", "ADMIN"]:
        return VALID_TOKENS_FULL
    return VALID_TOKENS_FREE

# =========================
# Compatibility aliases
# (expected by core.entitlements)
# =========================
def _pick_first_existing(*names, default=None):
    for n in names:
        if n in globals():
            return globals()[n]
    return default

def _normalize_tokens(x):
    if x is None:
        return []
    if isinstance(x, (set, tuple)):
        x = list(x)
    if isinstance(x, dict):
        # sometimes maps token->meta; take keys
        x = list(x.keys())
    out = []
    for t in x:
        if t is None:
            continue
        s = str(t).strip().upper()
        if not s:
            continue
        if s not in out:
            out.append(s)
    return out

# Trial tokens (fallback: BTC/ETH)
if "VALID_TOKENS_TRIAL" not in globals():
    VALID_TOKENS_TRIAL = _normalize_tokens(
        _pick_first_existing(
            "TOKENS_TRIAL",
            "SUPPORTED_TOKENS_TRIAL",
            "TRIAL_TOKENS",
            "ALLOWED_TOKENS_TRIAL",
            default=["BTC","ETH"]
        )
    )

# Full tokens (fallback: Top5 Swing: BTC/ETH/SOL/BNB/XRP)
if "VALID_TOKENS_FULL" not in globals():
    VALID_TOKENS_FULL = _normalize_tokens(
        _pick_first_existing(
            "TOKENS_FULL",
            "SUPPORTED_TOKENS_FULL",
            "FULL_TOKENS",
            "ALLOWED_TOKENS_FULL",
            default=["BTC","ETH","SOL","BNB","XRP"]
        )
    )

